(this["webpackJsonpblog-list-frontend"]=this["webpackJsonpblog-list-frontend"]||[]).push([[0],{113:function(e,t,n){"use strict";n.r(t);n(78);var r=n(0),c=n.n(r),a=n(20),s=n(15),i=n(19),u=n(10),o=n(18),l=n(7),j=n.n(l),b=n(47),d=n(148),f=n(162),p=n(25),O=n.n(p),h="/api/blogs",x=null,v=function(){var e=Object(u.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get(h);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(u.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:x}},e.next=3,O.a.post(h,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(u.a)(j.a.mark((function e(t,n){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("service",n),e.next=3,O.a.post("".concat(h,"/").concat(t,"/comments"),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),w=function(){var e=Object(u.a)(j.a.mark((function e(t,n){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.put("".concat(h,"/").concat(t),n);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),y=function(){var e=Object(u.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:x}},console.log(n),e.next=4,O.a.delete("".concat(h,"/").concat(t),n);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k={setToken:function(e){x="bearer ".concat(e)},getAll:v,create:g,createComment:m,update:w,deleteBlog:y},S=n(24),T=function(e,t){return function(){var n=Object(u.a)(j.a.mark((function n(r){return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r({type:"SET_NOTI",data:e});case 2:setTimeout((function(){r({type:"CLEAR_NOTI"})}),1e3*t);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTI":return t.data;case"CLEAR_NOTI":return null;default:return e}},C=function(e){return function(){var t=Object(u.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.create(e);case 2:r=t.sent,n({type:"NEW_BLOG",data:r}),n(T("a new blog ".concat(e.title," by ").concat(e.author," added"),5));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},I=function(e){return function(){var t=Object(u.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"UPDATE_BLOG",data:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOG":case"UPDATE_BLOG":return t.data;case"NEW_BLOG":return[].concat(Object(S.a)(e),[t.data]);default:return e}},_=n(2),B=function(e){var t=e.blogs,n=Object(i.b)(),c=Object(s.f)(),a=Object(r.useState)(""),l=Object(o.a)(a,2),p=l[0],O=l[1],h=Object(s.g)("/blogs/:id"),x=h?t.find((function(e){return e.id===h.params.id})):null,v=function(){var e=Object(u.a)(j.a.mark((function e(r){var c,a,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.find((function(e){return e.id===r})),a={user:c.user,likes:c.likes+1,author:c.author,title:c.title,url:c.url},e.next=4,k.update(r,a);case 4:s=e.sent,n(I(t.map((function(e){return e.id!==r?e:s}))));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(u.a)(j.a.mark((function e(r){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(r),!window.confirm("Do you really want to delete the blog?")){e.next=6;break}return e.next=4,k.deleteBlog(r);case 4:n(I(t.filter((function(e){return e.id!==r})))),c.push("/");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(u.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n={comment:p},e.next=4,k.createComment(x.id,n);case 4:O("");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return x?Object(_.jsxs)("div",{children:[Object(_.jsxs)("div",{children:[Object(_.jsxs)(b.a,{variant:"h6",children:[x.title," by ",x.author]}),Object(_.jsx)("a",{href:x.url,children:x.url})," ",Object(_.jsx)("br",{}),Object(_.jsx)("span",{id:"likes",children:x.likes}),Object(_.jsx)(d.a,{id:"like-button",onClick:function(){return v(x.id)},children:"like"})," ",Object(_.jsx)("br",{}),"added by ",void 0!==x.user?x.user.name:""," ",Object(_.jsx)("br",{}),Object(_.jsx)(d.a,{color:"secondary",id:"delete-button",onClick:function(){return g(x.id)},children:"remove"})]}),Object(_.jsxs)("div",{children:[Object(_.jsx)(b.a,{variant:"h6",children:"Comments"}),Object(_.jsxs)("form",{onSubmit:function(){return m()},children:[Object(_.jsx)(f.a,{id:"comment-input",type:"text",value:p,name:"Comment",onChange:function(e){var t=e.target;return O(t.value)}}),Object(_.jsx)(d.a,{id:"comment-button",type:"onSubmit",children:"add comment"})]}),Object(_.jsx)("ul",{children:x.comments?x.comments.map((function(e){return Object(_.jsx)("li",{children:e.comment},e.id)})):null})]})]}):null},N=n(150),L=n(114),A=n(151),R=n(152),D=n(153),G=n(154),J=function(e){var t=e.blog;return Object(_.jsxs)(a.b,{to:"/blogs/".concat(t.id),children:[t.title," ",t.author]})},P=c.a.forwardRef((function(e,t){var n=Object(r.useState)(null),c=Object(o.a)(n,2),a=c[0],s=c[1],i={display:a?"none":""},u={display:a?"":"none"},l=function(){s(!a)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:l}})),Object(_.jsxs)("div",{children:[Object(_.jsx)("div",{style:i,children:Object(_.jsx)(d.a,{id:e.buttonLabel,onClick:l,children:e.buttonLabel})}),Object(_.jsxs)("div",{style:u,children:[e.children,Object(_.jsx)(d.a,{onClick:l,children:"cancel"})]})]})}));P.displayName="Toggable";var W=P,z=function(){var e=Object(i.b)(),t=Object(r.useRef)(),n=Object(r.useState)(""),c=Object(o.a)(n,2),a=c[0],s=c[1],l=Object(r.useState)(""),b=Object(o.a)(l,2),p=b[0],O=b[1],h=Object(r.useState)(""),x=Object(o.a)(h,2),v=x[0],g=x[1],m=function(){var n=Object(u.a)(j.a.mark((function n(r){return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r.preventDefault(),e(C({title:a,author:p,url:v})),t.current.toggleVisibility(),s(""),O(""),g("");case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return Object(_.jsx)(W,{id:"new-blog",buttonLabel:"create new blog",ref:t,children:Object(_.jsxs)("form",{onSubmit:m,children:[Object(_.jsx)("div",{children:Object(_.jsx)(f.a,{id:"title",type:"text",value:a,name:"Title",label:"Title",onChange:function(e){var t=e.target;return s(t.value)}})}),Object(_.jsx)("div",{children:Object(_.jsx)(f.a,{id:"author",type:"text",value:p,name:"Author",label:"Author",onChange:function(e){var t=e.target;return O(t.value)}})}),Object(_.jsx)("div",{children:Object(_.jsx)(f.a,{id:"url",type:"text",value:v,name:"Url",label:"Url",onChange:function(e){var t=e.target;return g(t.value)}})}),Object(_.jsx)(d.a,{id:"create-blog",type:"onSubmit",children:"create"})]})})},V=function(e){var t=e.blogs;return Object(_.jsxs)("div",{children:[Object(_.jsx)("h2",{children:"Create new"}),Object(_.jsx)(z,{}),Object(_.jsx)(N.a,{component:L.a,children:Object(_.jsx)(A.a,{children:Object(_.jsx)(R.a,{children:t?t.sort((function(e,t){return e.likes<t.likes})).map((function(e){return Object(_.jsxs)(D.a,{children:[Object(_.jsx)(G.a,{children:Object(_.jsx)(J,{blog:e},e.id)}),Object(_.jsx)(G.a,{children:e.user.name})]},e.id)})):null})})})]})},H=n(161),M=n(155),q=n(156),F=n(163),K=function(e){var t=e.message;return null===t?null:Object(_.jsx)("div",{children:t&&Object(_.jsx)(F.a,{severity:"success",children:t})})},Q=function(e){return function(){var t=Object(u.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SET_USER",data:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return"SET_USER"===t.type?t.data:e},Y=function(e){var t=e.message,n=e.user,r=Object(i.b)(),c=Object(s.f)(),o=function(){window.localStorage.removeItem("loggedBlogappUser"),r(function(){var e=Object(u.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"SET_USER",data:null});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),c.push("/login")};return Object(_.jsxs)("div",{children:[Object(_.jsx)(M.a,{position:"static",children:Object(_.jsxs)(q.a,{children:[Object(_.jsx)(d.a,{color:"inherit",component:a.b,to:"/",children:"blogs"}),Object(_.jsx)(d.a,{color:"inherit",component:a.b,to:"/users",children:"users"}),n?n.name:null," logged-in",Object(_.jsx)(d.a,{id:"logout-button",onClick:function(){return o()},children:"logout"})]})}),Object(_.jsx)(b.a,{variant:"h5",children:"Blog app"}),Object(_.jsx)(K,{message:t})]})},Z=function(){var e=Object(u.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$={login:Z},ee=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.notifications})),n=Object(s.f)(),c=Object(r.useState)(""),a=Object(o.a)(c,2),l=a[0],p=a[1],O=Object(r.useState)(""),h=Object(o.a)(O,2),x=h[0],v=h[1],g=function(){var t=Object(u.a)(j.a.mark((function t(r){var c;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),t.next=3,$.login({username:l,password:x});case 3:c=t.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(c)),k.setToken(c.token),e(Q(c)),p(""),v(""),n.push("/blog-list");case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(_.jsxs)("div",{children:[Object(_.jsx)(K,{message:t}),Object(_.jsx)(b.a,{variant:"h4",children:"Login"}),Object(_.jsxs)("form",{onSubmit:g,children:[Object(_.jsx)("div",{children:Object(_.jsx)(f.a,{id:"username",type:"text",value:l,name:"Username",label:"Username",onChange:function(e){var t=e.target;return p(t.value)}})}),Object(_.jsx)("div",{children:Object(_.jsx)(f.a,{id:"password",type:"password",value:x,name:"Password",label:"Password",onChange:function(e){var t=e.target;return v(t.value)}})}),Object(_.jsx)(d.a,{color:"primary",id:"login-button",type:"submit",children:"login"})]})]})},te=n(157),ne=n(149),re=n(158),ce=n(159),ae=function(e){var t=e.blogs,n=Object(s.g)("/users/:id"),r=n?t.filter((function(e){return e.user.id===n.params.id})):null;return t[0]?Object(_.jsxs)("div",{children:[Object(_.jsx)(b.a,{variant:"h4",children:t[0].user.name}),Object(_.jsx)(b.a,{variant:"h5",children:"Added blogs"}),Object(_.jsx)(te.a,{container:!0,spacing:2,children:Object(_.jsx)(te.a,{item:!0,xs:12,md:6,children:Object(_.jsx)(ne.a,{dense:!0,children:r.map((function(e){return Object(_.jsx)(re.a,{children:Object(_.jsx)(ce.a,{primary:e.title})},e.id)}))})})})]}):null},se=n(160),ie=function(e){var t=e.users;return console.log(t),t[0]?Object(_.jsxs)("div",{children:[Object(_.jsx)("h2",{children:"Users"}),Object(_.jsx)(N.a,{component:L.a,children:Object(_.jsxs)(A.a,{children:[Object(_.jsx)(se.a,{children:Object(_.jsxs)(D.a,{children:[Object(_.jsx)(G.a,{}),Object(_.jsx)(G.a,{children:Object(_.jsx)("b",{children:"blogs created"})})]})}),Object(_.jsx)(R.a,{children:t.map((function(e){return Object(_.jsxs)(D.a,{children:[Object(_.jsx)(G.a,{children:Object(_.jsx)(a.b,{to:"/users/".concat(e.id),children:e.name})}),Object(_.jsx)(G.a,{children:e.blogs?e.blogs.length:0})]},e.id)}))})]})})]}):null},ue=function(){var e=Object(u.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),oe={getUsers:ue},le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return"INIT_USERS"===t.type?t.data:e},je=function(){var e=Object(i.c)((function(e){return e.login})),t=Object(i.c)((function(e){return e.blogs})),n=Object(i.c)((function(e){return e.users})),c=Object(i.c)((function(e){return e.notifications})),o=Object(i.b)();return Object(r.useEffect)((function(){o(function(){var e=Object(u.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.getAll();case 2:n=e.sent,t({type:"INIT_BLOG",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[o]),Object(r.useEffect)((function(){o(function(){var e=Object(u.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe.getUsers();case 2:n=e.sent,t({type:"INIT_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[o]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);k.setToken(t.token),o(Q(t))}}),[]),Object(_.jsx)(H.a,{children:Object(_.jsx)(a.a,{children:Object(_.jsxs)(s.c,{children:[Object(_.jsxs)(s.a,{path:"/users/:id",children:[e?Object(_.jsx)(Y,{message:c,user:e}):null,Object(_.jsx)(ae,{blogs:t})]}),Object(_.jsxs)(s.a,{path:"/users",children:[e?Object(_.jsx)(Y,{message:c,user:e}):null,Object(_.jsx)(ie,{users:n})]}),Object(_.jsxs)(s.a,{path:"/blogs/:id",children:[e?Object(_.jsx)(Y,{message:c,user:e}):null,Object(_.jsx)(B,{blogs:t})]}),Object(_.jsx)(s.a,{path:"/login",children:Object(_.jsx)(ee,{})}),Object(_.jsxs)(s.a,{path:"/",children:[e?Object(_.jsx)(Y,{message:c,user:e}):null,Object(_.jsx)(V,{blogs:t})]})]})})})},be=n(11),de=n.n(be),fe=n(42),pe=n(69),Oe=n(70),he=Object(fe.combineReducers)({blogs:U,notifications:E,login:X,users:le}),xe=Object(fe.createStore)(he,Object(pe.composeWithDevTools)(Object(fe.applyMiddleware)(Oe.a)));de.a.render(Object(_.jsx)(i.a,{store:xe,children:Object(_.jsx)(a.a,{children:Object(_.jsx)(je,{})})}),document.getElementById("root"))},78:function(e,t,n){}},[[113,1,2]]]);
//# sourceMappingURL=main.889f4f96.chunk.js.map